@using System.Web.Optimization
@model iDAS.Models.ModelStudent
@{
    int _resultCount = Model.StudentMonthlyFeeList.Count();

}
<!-- end: Favicon -->
@System.Web.Optimization.Scripts.Render("~/js/DataTable")
<script type="text/javascript">
    $(document).ready(function () {
        var handleDataTableButtons = function () {
            if ($("#datatable-responsive-FeeHistoryRecord").length) {
                $("#datatable-responsive-FeeHistoryRecord").DataTable({
                    dom: "Bfrtip",
                    "order": [],
                    buttons: [
                      {
                          extend: "copy",
                          className: "btn-sm"
                      },
                      {
                          extend: "csv",
                          className: "btn-sm"
                      },
                      {
                          extend: "excel",
                          className: "btn-sm"
                      },
                      //{
                      //    extend: "pdfHtml5",
                      //    className: "btn-sm"
                      //},
                      {
                          extend: "print",
                          className: "btn-sm"
                      },
                    ],

                    responsive: true
                });
            }
        };

        TableManageButtons = function () {
            "use strict";
            return {
                init: function () {
                    handleDataTableButtons();
                }
            };
        }();

        //$('#datatable-responsive-transactionHistory').DataTable();
        TableManageButtons.init();


    });

</script>
<!-- bootstrap-daterangepicker -->
<script type="text/javascript">


    $(document).ready(function () {

        $('#popFeeDatePicker').daterangepicker({
            singleDatePicker: true,
            calender_style: "picker_2"
        }, function (start, end, label) {
            console.log(start.toISOString(), end.toISOString(), label);
        });

    });

</script>
<!-- /bootstrap-daterangepicker -->
<div class="clearfix"></div>
<div class="row">
    <div class="col-md-12 col-sm-12 col-xs-12">
        <div class="x_panel">
            <div class="form-group">
                <label class="control-label col-md-3 col-sm-3 col-xs-3" for="StudentName">
                    Student Name :
                </label>
                <div class="col-md-3 col-sm-3 col-md-3">
                    @Html.DisplayTextFor(m => m.StudentName)
                </div>

                <label class="control-label col-md-3 col-sm-3 col-xs-3" for="first-name">
                    Father Name :
                </label>
                <div class="col-md-3 col-sm-3 col-md-3">
                    @Html.DisplayTextFor(m => m.FatherName)
                </div>
            </div>
            <br />
            <div class="form-group">
                <label class="control-label col-md-3 col-sm-3 col-xs-3" for="StudentName">
                    Class Name :
                </label>
                <div class="col-md-3 col-sm-3 col-md-3">
                    @Html.DisplayTextFor(m => m.StudentClass.ClassName)
                </div>

                <label class="control-label col-md-3 col-sm-3 col-xs-3" for="first-name">
                    Section :
                </label>
                <div class="col-md-3 col-sm-3 col-md-3">
                    @Html.DisplayTextFor(m => m.StudentSection.SectionName)
                </div>
            </div>
        </div>
    </div>
</div>
<div class="clearfix"></div>
<div class="row">
    <div class="col-md-12 col-sm-12 col-xs-12">
        <div class="x_panel">
            <div class="x_title">
                <h2>Records (@_resultCount)</h2>
                <div class="clearfix"></div>
            </div>
            <div class="x_content">
                @if (Model.StudentMonthlyFeeList.Count() > 0)
                {
                    @*<p class="text-muted font-13 m-b-30">
                            User transction history
                        </p>*@
                    <table id="datatable-responsive-FeeHistoryRecord" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0">
                        <thead>
                            <tr>
                                <th>Sr. No.</th>
                                <th>Fee Date</th>
                                <th>Fee Month</th>
                                <th>Admin. Fee</th>
                                <th>Admin.</th>
                                <th>Re-Admin Fee</th>
                                <th>Reg. Fee</th>
                                <th>Mon. Fee</th>
                                <th>Comp. Fee</th>
                                <th>Fine</th>
                                <th>Exam Fee</th>
                                <th>Gen. Fee</th>
                                <th>Total</th>
                                <th>Paid Status</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>

                            @foreach (var item in Model.StudentMonthlyFeeList.OrderByDescending(m => m.SerialNo))
                            {
                                <tr>
                                    
                                    @if (item.FeePaidStatus == 1)
                                    {
                                        <td>@item.SerialNo</td>
                                        <td>
                                            @item.FeeDate.ToString("dd/MM/yyyy")
                                        </td>
                                        <td>@item.FeeMonth</td>
                                        <td>@item.AdmissionFee</td>
                                        <td>@item.Admission</td>
                                        <td>@item.ReAdmissionFee</td>
                                        <td>@item.RegistrationFee</td>
                                        <td>@item.MonthlyFee</td>
                                        <td>@item.ComputerFee</td>
                                        <td>@item.Fine</td>
                                        <td>@item.ExamFee</td>
                                        <td>@item.GeneratorFee</td>
                                        <td>@item.Total</td>
                                        <td class="btn-success"><i class="ok-sign">Paid</i></td>
                                    }
                                    else if (item.FeePaidStatus == 0)
                                    {
                                        <td>@item.SerialNo</td>
                                    <td>
                                        <div>
                                            <input type="text" value='@item.FeeDate.ToString("dd/MM/yyyy")' class="form-control has-feedback-left" id="popFeeDatePicker" placeholder="Date of Fee Received" aria-describedby="inputSuccess2Status2">
                                            <span class="fa fa-calendar-o form-control-feedback left" aria-hidden="true"></span>
                                            <span id="inputSuccess2Status2" class="sr-only">(success)</span>
                                        </div>
                                    </td>
                                    <td>@item.FeeMonth</td>
                                    <td>@item.AdmissionFee</td>
                                        <td>@item.Admission</td>
                                    <td>@item.ReAdmissionFee</td>
                                    <td>@item.RegistrationFee</td>
                                    <td>@item.MonthlyFee</td>
                                    <td>@item.ComputerFee</td>
                                    <td>@item.Fine</td>
                                    <td>@item.ExamFee</td>
                                    <td>@item.GeneratorFee</td>
                                    <td>@item.Total</td>
                                        
                                        <td class="btn-warning"><i class="warning-sign">Not Paid</i></td>
                                    }
                                    else
                                    {
                                        <td class="btn btn-default">
                                            <i class="remove-sign">Unknown</i>
                                        </td>
                                    }
                                    @if (item.FeePaidStatus == 1)
                                    {
                                        <td></td>
                                    }
                                    else if (item.FeePaidStatus == 0)
                                    {
                                        <td>
                                            <a class="btn btn-success" href="#">
                                                <i class=" glyphicon glyphicon-print white"></i>&nbsp;Print
                                            </a>
                                            <a class="btn btn-primary" href="#">
                                                <i class=" glyphicon glyphicon-ok white"></i>&nbsp; Paid
                                            </a>
                                            @Ajax.ActionLink("Edit", "GetStudentSingleFeeRecord", "StudentFee", new { feeID = item.FeeId }, new AjaxOptions
                                            {
                                                InsertionMode = InsertionMode.Replace,
                                                HttpMethod = "POST",
                                                UpdateTargetId = "dvUpdateStudentMonthlyFeeForm",
                                                OnSuccess = "ShowUpdateStudentFeeModel();"
                                            }, new { @class = "btn btn-info glyphicon glyphicon glyphicon-pencil white" })
                                        </td>
                                    }
                                    else
                                    {
                                        <td class="btn btn-default">
                                            <i class="remove-sign">Unknown</i>
                                        </td>
                                    }


                                </tr>
                            }
                        </tbody>
                    </table>
                }
                else
                {
                    <div class="alert alert-info">
                        <button type="button" class="close" data-dismiss="alert">×</button>
                        <h4 class="alert-heading">Attention!</h4>
                        <p>No Record Found.</p>
                    </div>
                }
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">

    function ShowUpdateStudentFeeModel() {
        var $confirm = $("#ShowUpdateStudentMonthlyFeeModal");
        $confirm.modal("show");
    };
    function HideUpdateStudentFeeModel() {
        var $confirm = $("#ShowUpdateStudentMonthlyFeeModal");
        $confirm.modal("hide");
    };

    $(document).ready(function () {
       
        $('.updateStudentFeeModelHide').click(function () {
            $('#ShowUpdateStudentMonthlyFeeModal').modal('hide');
        });
    });

</script>
<!-- PopUp Success -->
<!-- Button trigger modal -->
<button id="btnShowSuccessUpdateStudentFee" type="button" class="btn" data-toggle="modal" style="visibility: hidden;"
        data-target="#ShowUpdateStudentMonthlyFeeModal"></button>
<!-- Modal -->
<div class="modal fade" id="ShowUpdateStudentMonthlyFeeModal" tabindex="-1" role="dialog" aria-labelledby="ShowUpdateStudentMonthlyFeeLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close updateStudentFeeModelHide" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title text-success" id="ShowUpdateStudentMonthlyFeeLabel">
                    Update Student Fee
                </h4>
            </div>
            <div id="dvUpdateStudentMonthlyFeeForm" class="modal-body">


            </div>
            <div class="modal-footer">
                <button id="btnModelUpdateStudentOK" type="button" class="btn btn-primary" onclick="$('#frmEditStudentMonthlyFee').submit();">
                    Update
                </button>
                <button id="btnModelUpdateStudentCancel" type="button" class="btn btn-default updateStudentFeeModelHide">
                    Close
                </button>
            </div>
        </div>
    </div>
</div>
<!-- PopUp Success -->